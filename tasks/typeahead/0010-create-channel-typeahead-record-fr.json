
{
  "tasks": [
    {
      "taskCode": "CreateDataCollection",
      "taskConfigurationTemplate": {
        "in": {"properties": [
            "SERVICE_ID.raw", 
            "SERVICE_NAME_EN_EXTERNAL.raw", 
            "SERVICE_NAME_FR_EXTERNAL.raw", 
            "SERVICE_CALLSIGN.raw", 
            "CATEGORY_NAME.raw"]},
        "params": {
          "datareposervice_host": "{DATA_REPOSITORY_SERVICE_HOST}",
          "datareposervice_port": "{DATA_REPOSITORY_SERVICE_PORT}",
          "customerCode": "{CUSTOMER_CODE}",
          "dataRepositoryCode": "{DATA_REPOSITORY_CODE}",
          "dataCollectionCode": "typeahead-record",
          "dataRecordIdentifierProperty": "dimval~unique_id",
          "successIfExists": true
        }
      }
    },
    {
      "taskCode": "UniqueDataRecordPropertiesToDataRecord",
      "taskConfigurationTemplate": {
        "params": {
            "datareposervice_host": "localhost",
            "datareposervice_port": "40380",
            "customer_code": "rogers",
              "datarepo_code": "eclipse-dev",
              "datarepo_collection_code": "clicc-channels-source"
        }
      }
    },
   {
      "taskCode": "HydrateDataRecord",
      "taskConfigurationTemplate": {
        "params": {
          "hydrate_configuration": [

            {
            "matchConfiguration": {
              "customerCode": "rogers",
              "dataRepositoryCode": "eclipse-dev",
              "dataCollectionCode": "clicc-pom-to-clicc-source",
              "baseRecordLookupPropertyName": "SERVICE_ID",
              "lookupIdPropertyNames": ["SERVICE_ID"],
              "uniqueRecords": true
            },
            "enrichConfiguration": {
              "ute~sku~channel~pom~id": "$.matchingRecords[*].POM_ID",
              "pomId": "$.matchingRecords[*].POM_ID"
              
            }
          }
        ]
        }
      }
   },

   {
    "taskCode": "HDR2",
      "taskClass": "HydrateDataRecord",
      "taskConfigurationTemplate": {
        "params": {
          "hydrate_configuration": [
            {
              "matchConfiguration": {
                "customerCode": "rogers",
                "dataRepositoryCode": "eclipse-dev",
                "dataCollectionCode": "teamsite-channel-content-source",
                "baseRecordLookupPropertyName": "ute~sku~channel~pom~id",
                "lookupIdPropertyNames": ["english.product_info.product_ID.raw"],
                "uniqueRecords": true
              },
              "enrichConfiguration": {
                "ute~sku~channel~title~fr": "$.matchingRecords[0].french.product_info.product_title",
                "ute~sku.channel~shortDescription~fr": "$.matchingRecords[0].french.product_info.short_desc",
                "ute~image~1": "$.matchingRecords[0].french.product_images1.image_from_teamsite",
                "ute~image~2": "$.matchingRecords[0].french.product_images2.image_from_teamsite",
                "ute~image~3": "$.matchingRecords[0].french.product_images3.image_from_teamsite"
              }
            }
        ]
        }
      }
   },

    {
      "taskCode": "CopyProperties",
      "taskConfigurationTemplate": {
        "params": {
          "copyProperties": [
            {"target":"dimval~unique_id", "source": "SERVICE_ID"},
            {"target":"dimval~spec","source": "SERVICE_NAME_FR_EXTERNAL"},
            {"target":"dimval~display_name","value": "{{{SERVICE_NAME_FR_EXTERNAL}}} dans les forfaits de télévision numérique"},
            {"target":"dimval~dimension_name","value": "typeahead.digital.channel.fr"},
            {"target":"dimval~display_order","value": ""},
            {"target":"dimval~parent_spec","value": "/"},
            {"target":"dimval~match~use_spec","value": "TRUE"},
            {"target":"dimval~search_synonym","value": ""},
            {"target":"dimval~range~lower_bound","value": ""},
            {"target":"dimval~range~lower_bound_inclusive","value": ""},
            {"target":"dimval~range~upper_bound","value": ""},
            {"target":"dimval~range~upper_bound_inclusive","value": ""},

            {"target":"ute~recordType", "value": "sku"},
            {"target":"ute~recordClass", "value": "channel"},
            {"target":"ute~lineOfBusiness", "value": "digitalCable"},
            {"target":"url", "value": "http://www.rogers.com/web/Rogers.portal?_nfpb=true&_pageLabel=PTV_PROG_PACKAGE"},
            {"target":"image", "source": "ute~image~2"}
          ]
        }
      }
    },
    {
      "taskCode": "PickProperties",
      "taskConfigurationTemplate": {
        "params": {
          "properties": [
            "dimval~unique_id",
            "dimval~spec",
            "dimval~display_name",
            "ute~recordType",
            "ute~recordClass",
            "ute~lineOfBusiness",
            "url",
            "dimval~dimension_name",
            "dimval~display_order",
            "dimval~parent_spec",
            "dimval~match~use_spec",
            "dimval~search_synonym",
            "dimval~range~lower_bound",
            "dimval~range~lower_bound_inclusive",
            "dimval~range~upper_bound",
            "dimval~range~upper_bound_inclusive",
            "image"
          ]
        }
      }
    },
    // {
    //  "taskCode": "Debug",
    //  "taskConfigurationTemplate": {
    //    "params": {}
    //  }
    // },
    {
      "taskCode": "DataRecordToDataRepositoryBulk",
      "taskConfigurationTemplate": {
        "params": {
          "customerCode": "rogers",
          "dataRepositoryCode": "eclipse-dev",
          "dataCollectionCode": "typeahead-record"
        }
      }
    }
    ]
}