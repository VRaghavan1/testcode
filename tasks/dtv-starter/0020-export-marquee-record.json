{
  "tasks": [
    {
      "taskCode": "Shell-RM",
      "taskConfigurationTemplate": {
        "in": {},
        "params": {
          "options": "-f",
          "filename": "{DATA_PROCESSING_FOUNDATION}/{TEMPDIRECTORY}/{TASK_FILENAME}.xml"
        }
      }
    },
    {
      "taskCode": "SQLiteRead",
      "taskConfigurationTemplate": {
        "params": {
            "sql": "{TASK_FOLDER}/get-marquee-record.sql",
            "connection": {
                "filename": "{DATA_PROCESSING_FOUNDATION}/{TEMPDIRECTORY}/clicc.db"
            },
            "loadSqlFromFile": true
        }
      }
    },
    {
      "taskCode": "CreateTombstoneProperties",
      "taskClass": "CreateProperties",
      "taskConfigurationTemplate": {
        "params": {
          "propertyNames": [
            "ute~recordType",
            "ute~recordClass",
            "ute~sourceSystem",
            "ute~lineOfBusiness"
          ],
          "propertyValues": [
            "supplementary",
            "postalCodeToChannelLineup",
            "curated",
            "digitalCable"
          ]
        }
      }
    },
    {
      "taskCode": "UpdateRecordClassProperties",
      "taskClass": "ChangePropertyNames",
      "taskConfigurationTemplate": {
        "params": {
          "replacePropertyNames": [
            {"source":"POSTAL_ZIP_CODE", "target":"ute~supplementary~postalCodeToService~postalCode"},
            {"source":"CHANNEL_LINEUP", "target":"ute~supplementary~postalCodeToService~channelLineup"},
            {"source":"SYSTEM_LINEUP_TYPE", "target":"ute~supplementary~postalCodeToService~systemLineupType"},
            {"source":"PROV_CODE", "target":"ute~supplementary~postalCodeToService~province"}
          ]
        }
      }
    },
    {
       "taskCode": "runScriptAddUniqueId",
       "taskClass": "RunScriptComponent",
       "taskConfigurationTemplate": {
         "params": {
           "script":
           "dataRecord['ute~internal~id'] =  _.snakeCase(dataRecord['ute~recordType'] + '-' + dataRecord['ute~recordClass'] + '-' + dataRecord['ute~sourceSystem'] + '-' + dataRecord['ute~supplementary~postalCodeToService~postalCode'] + '-' + dataRecord['ute~supplementary~postalCodeToService~channelLineup'] + '-' + dataRecord['ute~lineOfBusiness'] )"
         }
       }
     },
    {
      "taskCode": "ReplacePropertyNames",
      "taskConfigurationTemplate": {
        "params": {
          "pattern": "~",
          "replacement": ".",
          "property": "*"
        }
      }
    },
    {
      "taskCode": "PickProperties",
      "taskConfigurationTemplate": {
        "params": {
          "properties": ["ute.*"]
        }
      }
    },
//    {
//      "taskCode": "Debug",
//      "taskConfigurationTemplate": {
//        "params": {}
//      }
//    },
    {
      "taskCode": "DataRecordToEndecaXmlFile",
      "taskConfigurationTemplate": {
        "params": {
          "filename": "{DATA_PROCESSING_FOUNDATION}/{TEMPDIRECTORY}/{TASK_FILENAME}.xml"
        }
      }
    }
  ]
}
