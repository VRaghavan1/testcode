{
  "tasks": [
    {
      "taskCode": "CreateDataCollection-demo-show-record",
      "taskClass": "CreateDataCollection",
      "taskConfigurationTemplate": {
        "in": {"properties": [
            "ute~sku~channel~shows~en.raw", 
            "ute~sku~channel~system~id.raw",
            "ute~sku~channel~title~en.raw",
            "ute~image~2.raw"]},

        "params": {
          "datareposervice_host": "drs.conscia.co",
          "datareposervice_port": "40380",
          "customerCode": "rogers",
          "dataRepositoryCode": "demo",
          "dataCollectionCode": "shows",
          "authorization_code": "75834bea-04b3-411d-b487-62adb8b960e8",
          "dataRecordIdentifierProperty": "id",
          "name": "Show Records",
          "successIfExists": true
        }
      }
    },
    {
      "taskCode": "TruncateDataCollection-demo-show-record",
      "taskClass": "TruncateDataCollection",
      "taskConfigurationTemplate": {
        "params": {
          "datareposervice_host": "drs.conscia.co",
          "datareposervice_port": "40380",
          "customerCode": "rogers",
          "dataRepositoryCode": "demo",
          "dataCollectionCode": "shows",
          "authorization_code": "75834bea-04b3-411d-b487-62adb8b960e8"
        }
      }
    },
    {
      "taskCode": "UniqueDataRecordPropertiesToDataRecord",
      "taskConfigurationTemplate": {
        "params": {
            "datareposervice_host": "localhost",
            "datareposervice_port": "40380",
            "customer_code": "rogers",
              "datarepo_code": "eclipse-dev",
              "datarepo_collection_code": "demo-channel-record"
        }
      }
    },
  {
      "taskClass": "FilterDataRecord",
      "taskCode": "FilterDataRecord-Site",
      "taskConfigurationTemplate": {
        "params": {
          "condition": {
            "ute~sku~channel~system~id": {"$eq": "65HD"}
          }
        }
      }
    },


    {
      "taskClass": "NormalizeDataRecord",
      "taskCode": "NormalizeDataRecord-System",
      "taskConfigurationTemplate": {
        "params": {
          "property": ["ute~sku~channel~shows~en"]
        }
      }
    },



    {
      "taskCode": "GetSystems",
      "taskClass": "HydrateDataRecord",
      "taskConfigurationTemplate": {
        "params": {
          "hydrate_configuration": [
            {
            "matchConfiguration": {
              "customerCode": "rogers",
              "dataRepositoryCode": "eclipse-dev",
              "dataCollectionCode": "omdb",
              "baseRecordLookupPropertyName": "ute~sku~channel~shows~en",
              "lookupIdPropertyNames": ["Title"],
              "uniqueRecords": true,
              "useSearch": true
            },
            "enrichConfiguration": {
              "cast": "$.matchingRecords[*].Cast",
              "plot": "$.matchingRecords[*].Plot",
              "imdbID": "$.matchingRecords[*].imdbID"
            }
          }
          ]
        }
      }
    },
    {
      "taskCode": "CreateImageUrl",
      "taskClass": "RunScriptComponent",
      "taskConfigurationTemplate": {
        "params": {
          "script":
          "dataRecord['image'] = 'http://img.omdbapi.com/?i=' + dataRecord['imdbID'] + '&apikey=d28cb317&h=100'; "
        }
      }
    },

    // {
    //   "taskClass": "KeepUniqueValues",
    //   "taskCode": "KeepUniqueValues-System",
    //   "taskConfigurationTemplate": {
    //     "params": {
    //       "property": ["systemId"]
    //     }
    //   }
    // },
    // {
    //   "taskCode": "HydrateDataRecord2",
    //   "taskClass": "HydrateDataRecord",
    //   "taskConfigurationTemplate": {
    //     "params": {
    //       "hydrate_configuration": [
    //         {
    //         "matchConfiguration": {
    //           "customerCode": "rogers",
    //           "dataRepositoryCode": "eclipse-dev",
    //           "dataCollectionCode": "clicc-channels-source",
    //           "baseRecordLookupPropertyName": "SERVICE_ID",
    //           "lookupIdPropertyNames": ["SERVICE_ID"],
    //           "uniqueRecords": true,
    //           "lookupFilter": {
    //             "propertyName": "SYSTEM_TABNUM.raw",
    //             "operation": "term",
    //             "value": "{{{systemId}}}"
    //           }
    //         },
    //         "enrichConfiguration": {
    //           "ute~sku~channel~system~names": [
    //             "$.matchingRecords[*].SYSTEM_NAME"
    //           ],
    //           "ute~sku~channel~channelNumbers": [
    //             "$.matchingRecords",
    //             {
    //               "channel~id":"CHANNEL_ID",
    //               "channel~number":"CHANNEL_NUM"
    //             }
    //           ],
    //           "ute~sku~channel~productCode": [
    //             "$.matchingRecords[*].PRODUCT_CODE"
    //           ],
    //           "ute~sku~channel~system~cities": "$.matchingRecords[*].ute~sku~channel~system~cities",
    //           "ute~province": "$.matchingRecords[*].ute~sku~channel~province",
    //           "province": "$.matchingRecords[*].ute~sku~channel~province",
    //           "ute~sku~channel~stb": "$.matchingRecords[*].ute~sku~channel~stb"
    //         }
    //       }
    //       ]
    //     }
    //   }
    // },


   // {
   //    "taskCode": "GetCast",
   //    "taskClass": "HydrateDataRecord",
   //    "taskConfigurationTemplate": {
   //      "params": {
   //        "hydrate_configuration": [
   //        {
   //          "matchConfiguration": {
   //            "customerCode": "rogers",
   //            "dataRepositoryCode": "eclipse-dev",
   //            "dataCollectionCode": "omdb",
   //            "baseRecordLookupPropertyName": "ute.sku.channel.shows.en",
   //            "lookupIdPropertyNames": ["Title"],
   //            "uniqueRecords": true,
   //            "useSearch": true
   //          },
   //          "enrichConfiguration": {
   //            "ute.sku.channel.shows.cast": [
   //              "$.matchingRecords[0].Cast"
   //            ]
   //          }
   //        }
   //      ]
   //    }
   //    }
   //  }
   //  ,
    // {
    //   "taskCode": "SplitProperty",
    //   "taskConfigurationTemplate": {
    //     "params": {
    //       "property": ["ute.sku.channel.shows.en","ute.sku.channel.shows.fr"],
    //       "separator": "\n"
    //     }
    //   }
    // },

    // {
    //   "taskCode": "ReplacePropertyNames",
    //   "taskConfigurationTemplate": {
    //     "params": {
    //       "pattern": ".",
    //       "replacement": "~",
    //       "property": "*"
    //     }
    //   }
    // },

    //  {
    //    "taskCode": "DataRecordToJsonFile",
    //    "taskConfigurationTemplate": {
    //      "params": {
    //        "filename": "{DATA_PROCESSING_FOUNDATION}/temp/{TASK_FILENAME}.jsonl"
    //      }
    //    }
    //  }
    {
      "taskCode": "DataRecordToDataRepositoryBulk",
      "taskConfigurationTemplate": {
        "params": {
          "datareposervice_host": "drs.conscia.co",
          "datareposervice_port": "40380",
          "customerCode": "rogers",
          "dataRepositoryCode": "demo",
          "dataCollectionCode": "shows",
          "authorization_code": "75834bea-04b3-411d-b487-62adb8b960e8"
        }
      }
    }
  ]
}
